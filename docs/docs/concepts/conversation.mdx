# Chat Completion Format

Many language models are fine-tuned for chat-based interactions, enabling them to engage in natural conversations with users.
Through the conversation format, the model can understand a user’s natural-language query and generate an appropriate, context-aware response.
This process often referred to as **chat completion**.

Conventionally, in a chat completion setup, both **input** and **output** follow a structured format.
Messages are typically represented as follows:

```
[
  {
    "role": "system",
    "contents": [
      { "type": "text", "text": "You are a friendly and knowledgeable assistant." }
    ]
  },
  {
    "role": "user",
    "contents": [
      { "type": "text", "text": "Can you explain how photosynthesis works?" }
    ]
  }
]
```

When it is executed, the output might look like:
```
{
    "role": "assistant",
    "contents": [
        {
            "type": "text",
            "text": "Photosynthesis is the process by which plants convert sunlight, water, and carbon dioxide into energy. They use sunlight to produce glucose (a form of sugar) and release oxygen as a byproduct."
        }
    ]
}
```

## Message

A `Message` represents one conversational turn — what one participant (system, user, or assistant) says or does.

Each message contains:
- a **role**, indicating who is speaking,
- a set of **contents**, describing what was said or sent.

It associated with a specific role and a content.

### Role

|Role|Description|
|---|---|
|**system**|System instructions and constraints provided to the assistant. It usually defines the model’s behavior or persona.|
|**user**|Content authored by the end user.|
|**assistant**|Content authored by the assistant/model.|
|**tool**|Outputs produced by external tools/functions.|

### Contents

What is said from each role is generally referred to as content.
However, a model can operate in different modes, producing outputs that serve different purposes.

These outputs reflect the **intention** behind what the model says or performs.

|Intent|Description|
|---|---|
|**Content**|General output.|
|**Reasoning(thinking)**|Some model generates intermediate thoughts or reasoning traces before producing the final answer. These are stored in the reasoning field (often hidden from the user) and can help trace or visualize the model’s internal decision process.|
|**Tool call**|When the model decides to invoke an external function or API instead of generating plain text. These are represented as structured objects that describe which function to call(name) and with what arguments.|

These types of outputs are stored in separate fields within a message, making it possible to distinguish from general conversation.

**Example**

```
[
  Message {
      role: "assistant",
      reasoning: "Let’s reason step by step: photosynthesis converts light energy into chemical energy...",
      contents: [
          { type: "text", text: "Photosynthesis is the process by which plants convert sunlight, water, and carbon dioxide into energy." }
      ],
      tool_calls: [
          {
            type: "function",
            function: {
              id: "func_call_1234abcd",
              name: "get_current_location",
              arguments: ...
            }
          }
      ],
  },
]
```

## Parts

While `Contents` describe the intention of a message, `Part` defines the data type of that message.

Each Message contains a list of Part objects — the smallest semantic units within a conversation.
A Part can represent text, images, function calls, or any structured values, enabling rich multimodal communication.

|Part|Description|
|---|---|
|**Text**|Natural-language text content|
|**Image**|Visual data or reference (e.g., binary, URL, or metadata)|
|**Function**|Structured tool or function invocation|
|**Value**|Arbitrary data (numbers, objects, JSON values, etc.)|

For example, if a user asks about an image, the message could look like this:

```
[
  {type: "image", "image": {data: "..."}}
  {type: "text", text: "What you can see in this image?"} 
]
```

Together, these parts form the foundation for Ailoy’s multimodal and tool-augmented conversations — allowing the same structure to represent plain chat, reasoning traces, or complex tool workflows consistently.

## Delta

A `Delta` represents a partial update to a message — for example, during streaming responses.
When the model generates text token-by-token, each incremental addition is emitted as a delta, which is later merged into a full Message.

This design allows Ailoy to support streaming outputs, real-time reasoning traces, and incremental tool calls efficiently.
